# Домашнее задание к занятию 17 «Инцидент-менеджмент»

## Задание

Составьте постмортем на основе реального сбоя системы GitHub в 2018 году.

Информацию о сбое можно изучить по ссылкам ниже:

* [краткое описание на русском языке](https://habr.com/ru/post/427301/);
* [развёрнутое описание на английском языке](https://github.blog/2018-10-30-oct21-post-incident-analysis/).

| | |
| ------------------------ | ---------------- |
| Краткое описание инцидента: | 21 октября 2018 в 22:52 плановые работы по техническому обслуживанию по замене вышедшего из строя оптического оборудования 100G привели к потере соединения между нашим сетевым концентратором на восточном побережье США и нашим основным центром обработки данных на восточном побережье США. Соединение между этими точками было восстановлено за 43 секунды, но этот кратковременный сбой вызвал цепочку событий, которые привели к ухудшению качества обслуживания на 24 часа и 11 минут. |
| Предшествующие события: | Плановые работы по техническому обслуживанию по замене вышедшего из строя оптического оборудования 100G между сетевым концентратором на восточном побережье США и нашим основным ЦОД Github на восточном побережье США |
| Причина инцидента: | Замена оптического оборудования привела к потере соединения на 43 секунды между сетевым концентратором на восточном побережье США и нашим основным ЦОД Github на восточном побережье США |
| Воздействие: | Возникла несогласованность мета-данных в кластерах БД MySQL, в результате чего отображалась устаревшая и не последовательная информация на сервисе. |
| Обнаружение: | 22:54 Внутренние системы мониторинга начали генерировать оповещения, указывающие на многочисленные сбои. <br>23:02 инженеры группы быстрого реагирования определили, что топологии многочисленных кластеров баз данных находятся в неожиданном состоянии. Запрос к топологии репликации базы данных показал только серверы из ЦОД на западном побережье США. |
| Реакция: | 23:07 Группа реагирования решила вручную заблокировать внутренние инструменты развертывания, чтобы предотвратить внесение каких-либо дополнительных изменений. <br>23:09 Группа реагирования перевела сайт в желтый статус. <br>23:11 Был подключен координатор по инцидентам, который изменил решение на красный статус. |
| Восстановление: | Разработан план по устранению несогласованности данных и реализации процедур аварийного переключения для MySQL: <br> - Восстановление из резервных копий <br> - Синхронизация реплики на обоих сайтах <br> - Возвращение к стабильной топологии обслуживания <br> - Возобновление обработки заданий в очереди. |
| Таймлайн: | <br> 21 октября 2018 <br> 22:54 Внутренние системы мониторинга начали генерировать оповещения, указывающие на многочисленные сбои. <br>23:02 инженеры группы быстрого реагирования определили, что топологии многочисленных кластеров баз данных находятся в неожиданном состоянии. Запрос к топологии репликации базы данных показал только серверы из ЦОД на западном побережье США. <br>23:07 Группа реагирования решила вручную заблокировать внутренние инструменты развертывания, чтобы предотвратить внесение каких-либо дополнительных изменений. <br>23:09 Группа реагирования перевела сайт в желтый статус. <br>23:11 Был подключен координатор по инцидентам, который изменил решение на красный статус.<br><br>22 октября 2018 <br>00:05 Произведено информирование пользователей, о контролируемом переходе на другой ресурс внутренней системы хранения данных. <br>00:41 Начат процесс резервного копирования для всех затронутых кластеров MySQL <br>06:51 Восстановление нескольких кластеров БД из резервных копий в ЦОД на восточном побережье США и начало репликации новых данных с западного побережья. <br>07:46 Публикация в блоге GitHub информации о сбое БД <br>11:12 Все первичные базы данных снова установлены на восточном побережье США. <br>13:15 Ввод дополнительных реплик чтения MySQL в общедоступном облаке Восточного побережья США, для нормализации скорости восстановления, в связи с пиковой нагрузкой трафика на сайт. <br>16:24 Синхронизация реплик и переход на исходную топологию для решения проблемы с задержкой и доступностью <br>16:45 Балансировка возросшей нагрузки на сайт <br>23:03 Все задачи ожидающие сборки веб-перехватчиков и страниц были обработаны, а целостность и правильная работа всех систем подтверждены. Статус сайта обновился на зеленый. |
| Последующие действия | - Пересмотр оценки времени восстановления после инцидентов, для предоставления более точной информации пользователям <br> - Настройка конфигурации Orchestrator, чтобы предотвратить распространение основных баз данных за пределы региональных границ. <br> - Ускорение перехода на новый механизм отчетности о статусе, который предоставит нам более обширную площадку для обсуждения активных инцидентов более четким и понятным языком. <br> - Увеличение приоритета инициативы по поддержке обслуживания трафика GitHub из нескольких ЦОД в схеме «активный-активный-активный». Целью этого проекта является поддержка резервирования N+1 на уровне объекта. Цель этой работы — выдержать полный отказ одного центра обработки данных без воздействия на пользователя. <br> - Инициатива по внедрению систематической практики проверки сценариев неудач, с применением инструментов внедрения ошибок и хаос-инжиниринга, до того, как они смогут повлиять на пользователей сервиса.


